
Library that I will be using are:

```{r}
library(ggplot2)
library(ggmap)
library(zipcode)
library(dplyr)
data(zipcode)
```


The data load to dataframe, and I just want to to observe for particular candidate, Obama and Romney.

```{r}
df = read.csv("fc2012ny.csv")

#Row wise, drop duplicated zip codes. And subsetting for two main candidates, Obama and Romney
#Column wise, selecting only two variable required, 3=cand_nm, 7=contbr_zip
rb_zip = subset(df[!duplicated('contbr_zip'),c(3,7)],
                cand_nm == 'Romney, Mitt' |
                cand_nm == 'Obama, Barack')
#Redefined the factor levels to only 2
rb_zip = droplevels(rb_zip)
```

This plot will show how many contributors for Obama and Romney.

```{r}
#Plotting by ggplot
ggplot(rb_zip,aes(x=cand_nm)) + geom_bar() +
  xlab('Candidate names')+
  ylab('Number of contributors')+
  ggtitle('Contributors for candidates presidential election 2012')+
  ggsave('plot.jpg',limitsize = T)
```

Even when we're doing bar chart. We can see Obama has almost 10 times contributors than Romney's. You can see that with this many contributors, Obama has more freedom to run his campaign compared to Romney.Below is the contigency table for Obama and Romney,

```{r}
table(rb_zip$cand_nm)
```


To help me with analysis, I use the cool zipcode package library from Jeffrey Breen. I extract the latitude, longitude and city (I did not use city in the df dataset, because it need some wrangling.) Since some of the people only fill 5 prefix zipcodes, I convert all of them into 5 prefix zipcodes. Then I use color to differentiate both candidates. Below I use another awesome plot package, ggmap by David Kahle and Hadley Wickham.

```{r}
#Clean and join the zipcode data, by Jeffrey Breen, author of R zipcode package.
rb_zip$contbr_zip = clean.zipcodes(rb_zip$contbr_zip)
zip_map= merge(rb_zip, zipcode, by.x = 'contbr_zip', by.y = 'zip')

#Draw original map of new york
map = get_map(location="ny",zoom=6,source="stamen")
#Plot the point
ggmap(map)+
  geom_point(data=zip_map,
             aes(x=longitude,y=latitude,colour=cand_nm))
 
```

Here we see that most of the contributors favor Obama over Romney. The plot is overplotting though. I'm going to limit based on the majority area of the contributors. Based on the plot, I can see that I may have pretty good estimate, If I limit latitude between 40 to 45, and longitude between -80 to -72. 

```{r}
zip_map.filtered = subset(zip_map,
                          !is.na(longitude) & 
                          !is.na(latitude) &
                          latitude > 40 & latitude < 45 &
                          longitude > -80 & longitude < -72)
```

Since I have so many category levels in the zip code. I group them based on the coordinate, round based on nearest integers. Than for each group, take the average of latitude and longitude. I create buble chart in the map. The higher the bubble, the higher the population in the area. I also have sequential colors that describe difference between obama and romney contributors. More blue means more contributors to Obama, brown means both contributors are roughly equal.

```{r}
zip_map.by_coor = group_by(zip_map.filtered,round(latitude),round(longitude))%>%
  summarise(latmean = mean(latitude),
            lonmean = mean(longitude),
            OfromR = table(cand_nm)["Obama, Barack"] - table(cand_nm)["Romney, Mitt"],
            count = n()) %>%
  ungroup()

#Create the ggmap,
# map =background of New York, stamen
# x = longitude
# y = latitude
# color = difference of Obama to Romney
# alpha = darker per 20 count
# size = based on the population in the area
# Color palette from Red to Blu
ggmap(map,fullpage = T)+
  geom_point(data=zip_map.by_coor,
             aes(x=lonmean,y=latmean,
                 colour=OfromR,
                 alpha=1/20,
                 size =count))+scale_size_area(max_size=50,breaks=c(1000,5000,10000,50000),guide=F)+
  scale_colour_distiller(palette = 'RdBu',
                         guide=guide_legend(title="difference contributors"))+
  scale_alpha(guide=F)+
  ggtitle('Map of New York contributors in 2012, for Obama and Romney')
```

Here we can see that majority of the contributors live in New York, the rest is live around New York.  Contributors in NY have sided with Obama the most than other area. This could also happen because this area have the highest population.Contributors in similar area(represented by its longtitude and latitude) have roughly equal differrence. But once again, this could also happen because it's too small to notice the difference.We can't neighborhood are in this level.But this serve as a good estimate of difference contributors across similar area.

